{{ Css('blog.css') }}

<div class="blogEntryImg">
	<img src="{{ Model.ImageUrl }}" />
</div>
<div class="blog">
	<h1 class="blogTitle">{{ Model.Title }}</h1><span class="publishInfo">Published by {{ Model.Author }} on {{ Model.PublishDate }}.</span>
	<section id="blogContent">
		{{ Model.Content }}
	</section>
</div>
<section id="blogComments">
	<form action="/blog/{{ Model.Id }}/comments" method="post" class="ajaxForm">
		 <input type='text' name='name' value='Riley Teige' required>
		 <input type='submit' value='submit'>
	</form>
	<div id="output">
	</div>
</section>

<script type="text/javascript">
(function($) {
	$.fn.serializeObject = function()
	{
	    var o = {};
	    var a = this.serializeArray();
	    $.each(a, function() {
	        if (o[this.name] !== undefined) {
	            if (!o[this.name].push) {
	                o[this.name] = [o[this.name]];
	            }
	            o[this.name].push(this.value || '');
	        } else {
	            o[this.name] = this.value || '';
	        }
	    });
	    return o;
	};

	$(function() {
		$('.ajaxForm[method="post"]').submit(function() {
			var output = $('#output');
			var form = $(this);

			var name = $(this).find('input[name="name"]').val();

			var formData = '{ "name":"' + name + '" }';

			console.log("Submitting: " + formData);

			$.post($(this).attr('action'), formData)
			.done(function(data) {
				output.append('Server response: ' + JSON.parse(data).data + '<br/>');
			})
			.fail(function(xhr, err, ex) {
				output.append('Something bad happened: ' + err + '<br/>');
				output.append('Exception: ' + ex + '<br/>');
			});

			return false;
		});
	});
})(jQuery);
</script>